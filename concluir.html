<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Concluir</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>

<style>
body{
  margin:0;
  background:#07000f;
  font-family:Arial,Helvetica,sans-serif;
  color:#fff;
  text-align:center;
}
#particles{position:fixed;inset:0}
.container{
  position:relative;
  z-index:1;
  padding:60px 20px;
}
h1{
  color:#c77dff;
  text-shadow:0 0 25px #9d4edd;
}
button,a{
  display:block;
  margin:16px auto;
  padding:14px;
  width:100%;
  max-width:360px;
  border-radius:12px;
  font-weight:bold;
  text-decoration:none;
  border:none;
}
.visit{
  background:#7b2cff;
  color:#fff;
  box-shadow:0 0 25px #7b2cff;
}
.confirm{
  background:#222;
  color:#aaa;
}
.confirm.active{
  background:#00ff88;
  color:#000;
  box-shadow:0 0 25px #00ff88;
}
#download{
  display:none;
  background:#00ff88;
  color:#000;
}
.progress{
  height:8px;
  background:#222;
  border-radius:6px;
  overflow:hidden;
  margin:22px auto;
  max-width:360px;
}
#bar{
  height:100%;
  width:0%;
  background:#9d4edd;
}
</style>
</head>

<body>
<div id="particles"></div>

<div class="container">
<h1 id="titulo">Concluir</h1>

<div class="progress"><div id="bar"></div></div>

<button class="visit" onclick="abrir()">VISITAR</button>
<button id="confirm" class="confirm" disabled onclick="liberar()">✔ JÁ VISITEI</button>
<a id="download" target="_blank">BAIXAR AGORA</a>
</div>

<script>
const params=new URLSearchParams(location.search);

const titulo=params.get("titulo");
const canalLink=params.get("canalLink");
const downloadLink=params.get("downloadLink");

if(titulo) document.getElementById("titulo").textContent=titulo;

const bar=document.getElementById("bar");
const confirmBtn=document.getElementById("confirm");
const download=document.getElementById("download");

let tempo=0;
const minimo=10;

function abrir(){
  if(!canalLink){
    alert("Link inválido");
    return;
  }

  // abre link (site ou app)
  location.href=canalLink;

  tempo=0;
  bar.style.width="0%";
  confirmBtn.disabled=true;
  confirmBtn.classList.remove("active");

  const timer=setInterval(()=>{
    tempo++;
    bar.style.width=(tempo/minimo*100)+"%";
    if(tempo>=minimo){
      clearInterval(timer);
      confirmBtn.disabled=false;
      confirmBtn.classList.add("active");
      bar.style.width="100%";
    }
  },1000);
}

function liberar(){
  if(!downloadLink){
    alert("Download inválido");
    return;
  }
  download.href=downloadLink;
  download.style.display="block";
}

particlesJS("particles",{
  particles:{
    number:{value:80},
    color:{value:"#9d4edd"},
    line_linked:{enable:true,color:"#7b2cff"},
    move:{enable:true,speed:2}
  }
});
</script>
</body>
</html>
